[{"title":"å•ç»†èƒžscRNA-seqåˆ†æžæ€è·¯æ€»ç»“","date":"2025-09-19T11:09:47.000Z","url":"/myblog.github.io/posts/%E5%8D%95%E7%BB%86%E8%83%9EscRNA-seq%E5%88%86%E6%9E%90%E6%80%9D%E8%B7%AF%E6%80%BB%E7%BB%93/","tags":[["å•ç»†èƒž","/myblog.github.io/tags/%E5%8D%95%E7%BB%86%E8%83%9E/"],["scRNA-seq","/myblog.github.io/tags/scRNA-seq/"]],"categories":[["undefined",""]],"content":"å•ç»†èƒžåˆ†æžæ€è·¯ï¼ŒæŠŠå¸¸è§çš„æ­¥éª¤å’Œé€»è¾‘æ¡†æž¶è®²æ¸…æ¥šã€‚è¿™é‡Œä¸»è¦ä»¥ å•ç»†èƒžè½¬å½•ç»„ï¼ˆscRNA-seqï¼‰ ä¸ºä¾‹ã€‚ å…·ä½“æµç¨‹ 1. æ•°æ®å‡†å¤‡ä¸Žè´¨æŽ§ (QC) è¾“å…¥ï¼šåŽŸå§‹ UMI/reads çŸ©é˜µï¼ˆç»†èƒž Ã— åŸºå› ï¼‰ã€‚ ç›®æ ‡ï¼šç­›æŽ‰ä½Žè´¨é‡ç»†èƒžï¼Œä¿è¯åˆ†æžç»“æžœå¯é ã€‚ å¸¸è§ QC æŒ‡æ ‡ï¼š æ¯ä¸ªç»†èƒžçš„æ€» reads/UMI æ•°ï¼ˆä½Žäº†å¯èƒ½æ˜¯åç»†èƒžï¼Œé«˜äº†å¯èƒ½æ˜¯åŒç»†èƒž doubletï¼‰ã€‚ æ£€æµ‹åˆ°çš„åŸºå› æ•°ã€‚ çº¿ç²’ä½“åŸºå› æ¯”ä¾‹ï¼ˆè¿‡é«˜è¯´æ˜Žç»†èƒžå¯èƒ½åæ­»ï¼‰ã€‚ æ“ä½œï¼š subsetã€filter åŽ»æŽ‰å¼‚å¸¸ç»†èƒžã€‚ DoubletFinder / Scrublet è¯†åˆ«åŒç»†èƒžã€‚ å…·ä½“æ–¹æ³• 2. æ ‡å‡†åŒ–ä¸Žç‰¹å¾é€‰æ‹© å½’ä¸€åŒ– (Normalize)ï¼š LogNormalizeï¼šæ¯ä¸ªç»†èƒžçš„ counts é™¤ä»¥æ€»æ•° Ã— scale.factorï¼Œå† log1pã€‚ æ ‡å‡†åŒ–æ„ä¹‰ æ¶ˆé™¤æ–‡åº“å¤§å°å·®å¼‚ æ¯ä¸ªç»†èƒžçš„è¡¨è¾¾é‡å˜æˆâ€œç›¸å¯¹è¡¨è¾¾â€ï¼Œèƒ½ç›´æŽ¥æ¯”è¾ƒä¸åŒç»†èƒžã€‚ çªå‡ºç”Ÿç‰©å·®å¼‚ é«˜è¡¨è¾¾çš„åŸºå› è¢« log åŽ‹ç¼©ï¼Œä¸è‡³äºŽä¸»å¯¼åŽç»­åˆ†æžï¼› ä¸­ä½Žè¡¨è¾¾çš„å·®å¼‚ä¼šæ›´æ˜Žæ˜¾ï¼Œåˆ©äºŽå‘çŽ° marker åŸºå› ã€‚ ä¸ºä¸‹æ¸¸åˆ†æžæä¾›å¯æ¯”æ€§è¾“å…¥ PCAã€èšç±»ã€UMAP ç­‰æ–¹æ³•éƒ½éœ€è¦è¾“å…¥å¯æ¯”è¾ƒçš„æ•°å€¼çŸ©é˜µã€‚ LogNormalize åŽçš„çŸ©é˜µèƒ½è®©ç®—æ³•çœŸæ­£æ•æ‰ç”Ÿç‰©å­¦å·®å¼‚ï¼Œè€Œä¸æ˜¯æŠ€æœ¯å™ªéŸ³ã€‚ é«˜å˜åŸºå› é€‰æ‹© (FindVariableFeatures)ï¼š æ‰¾å‡ºåœ¨ç»†èƒžé—´å˜å¼‚åº¦æœ€é«˜çš„ä¸€æ‰¹åŸºå› ï¼ˆå¸¸ç”¨ 2000ï¼‰ã€‚ å…·ä½“æ–¹æ³• ðŸ”¬ Seurat å†…ç½®çš„ä¸‰ç§æ–¹æ³• åœ¨ FindVariableFeatures() é‡Œå¯ä»¥è®¾ç½® selection.methodï¼š &quot;vst&quot;ï¼ˆVariance Stabilizing Transformationï¼‰ðŸ‘‰ é»˜è®¤ã€æŽ¨è æ€è·¯ï¼š å¯¹æ¯ä¸ªåŸºå› ï¼Œåœ¨æ‰€æœ‰ç»†èƒžé‡Œçš„è¡¨è¾¾åšæ–¹å·®ä¼°è®¡ï¼› æŠŠæ–¹å·®å’Œå‡å€¼ä¹‹é—´çš„å…³ç³»å»ºæ¨¡ï¼ˆè´ŸäºŒé¡¹åˆ†å¸ƒè¿‘ä¼¼ï¼‰ï¼› è®¡ç®—æ®‹å·®æ–¹å·®ï¼ˆobserved variance / expected varianceï¼‰ã€‚ ç‰¹ç‚¹ï¼š åœ¨åŽ»é™¤äº†å‡å€¼ä¾èµ–æ€§åŽï¼Œèƒ½ç¨³å¥åœ°æŒ‘å‡ºé«˜å˜åŸºå› ï¼› å¯¹é«˜è¡¨è¾¾åŸºå› ä¸ä¼šè¿‡åº¦åå‘ï¼› æŽ¨èä½œä¸ºå¤§å¤šæ•° scRNA-seq åˆ†æžçš„æ ‡å‡†æ–¹æ³•ã€‚ &quot;mean.var.plot&quot;ï¼ˆMVPï¼Œå‡å€¼-æ–¹å·®å›¾æ–¹æ³•ï¼‰ æ€è·¯ï¼š æŠŠåŸºå› æŒ‰å‡å€¼åˆ†æˆ binsï¼› è®¡ç®—æ¯ä¸ªåŸºå› åœ¨ bin å†…çš„ z-scoreï¼ˆæ–¹å·®ç›¸å¯¹ bin å†…åŸºå› çš„åé«˜ç¨‹åº¦ï¼‰ï¼› å–æ–¹å·®æœ€é«˜çš„ä¸€æ‰¹åŸºå› ã€‚ ç‰¹ç‚¹ï¼š æ–¹æ³•ç®€å•ç›´è§‚ï¼Œå¯ä»¥ç”»å›¾å±•ç¤ºï¼ˆMean-Variance Plotï¼‰ã€‚ å¯¹å™ªéŸ³å’Œæ‰¹æ¬¡æ•ˆåº”æ•æ„Ÿï¼Œä¸å¦‚ vst ç¨³å¥ã€‚ &quot;dispersion&quot;ï¼ˆç¦»æ•£åº¦æ–¹æ³•ï¼‰ æ€è·¯ï¼š ç±»ä¼¼äºŽ MVPï¼Œä½†ç›´æŽ¥ç”¨ æ ‡å‡†åŒ–åŽçš„æ–¹å·®/å‡å€¼æ¯”ï¼ˆdispersionï¼‰ æ¥æŒ‘åŸºå› ã€‚ ç‰¹ç‚¹ï¼š é€Ÿåº¦å¿«ï¼› ä½†å®¹æ˜“åå‘äºŽä½Žå‡å€¼ã€ç›¸å¯¹ç¦»æ•£åº¦é«˜çš„åŸºå› ã€‚ ç¼©æ”¾ (ScaleData)ï¼š Z-score æ ‡å‡†åŒ–åŸºå› è¡¨è¾¾ï¼Œç”¨äºŽ PCA ç­‰ã€‚ what is Z-score Z-scoreï¼ˆæ ‡å‡†åˆ†æ•°ã€æ ‡å‡†åŒ–å€¼ï¼‰æ˜¯ç»Ÿè®¡å­¦é‡Œå¸¸ç”¨çš„ä¸€ä¸ªæŒ‡æ ‡ï¼Œè¡¨ç¤ºä¸€ä¸ªæ•°å€¼åç¦»å¹³å‡å€¼å¤šå°‘ä¸ªæ ‡å‡†å·®ã€‚ å…¬å¼ï¼š z=xâˆ’Î¼Ïƒz=\\frac{xâˆ’Î¼}{Ïƒ} z=Ïƒxâˆ’Î¼â€‹ xï¼šæŸä¸ªè§‚æµ‹å€¼ Î¼ï¼šæ€»ä½“/æ ·æœ¬çš„å¹³å‡å€¼ Ïƒï¼šæ€»ä½“/æ ·æœ¬çš„æ ‡å‡†å·® åœ¨å•ç»†èƒžåˆ†æžé‡Œçš„åº”ç”¨ åœ¨ é«˜å˜åŸºå› ç­›é€‰ï¼ˆmean.var.plot æ–¹æ³•ï¼‰ ä¸­ï¼ŒSeurat ä¼šæŠŠåŸºå› æŒ‰è¡¨è¾¾å‡å€¼åˆ†æˆ binsï¼š å…ˆç®—æ¯ä¸ªåŸºå› çš„æ–¹å·®ï¼› å†å’ŒåŒ bin å†…çš„åŸºå› æ¯”è¾ƒï¼Œç”¨ z-score æ ‡å‡†åŒ–ï¼Œå¾—åˆ°å®ƒåœ¨è¯¥å‡å€¼æ°´å¹³ä¸‹æ˜¯å¦â€œæ¯”å¹³å‡æ›´ç¦»æ•£â€ã€‚ é«˜ z-score â†’ è¯´æ˜Žè¿™ä¸ªåŸºå› åœ¨åŒæ°´å¹³åŸºå› é‡Œâ€œæ›´å˜å¼‚â€ï¼Œå¯èƒ½æ˜¯é«˜å˜åŸºå› ã€‚ z-score å°±æ˜¯â€œæ ‡å‡†åŒ–çš„åç¦»ç¨‹åº¦â€ï¼Œå‘Šè¯‰ä½ ä¸€ä¸ªå€¼æ¯”å‡å€¼é«˜/ä½Žäº†å¤šå°‘ä¸ªæ ‡å‡†å·®ã€‚ åœ¨å•ç»†èƒžåˆ†æžé‡Œï¼Œå®ƒå¸¸è¢«ç”¨æ¥æ¯”è¾ƒåŸºå› åœ¨ä¸åŒå‡å€¼æ°´å¹³ä¸‹çš„æ–¹å·®æ˜¯å¦å¼‚å¸¸é«˜ï¼Œä»Žè€Œè¯†åˆ«é«˜å˜åŸºå› ã€‚ 3. é™ç»´ çº¿æ€§é™ç»´ (PCA)ï¼š æå–ä¸»è¦å˜å¼‚ç»´åº¦ã€‚ éžçº¿æ€§é™ç»´ (UMAP/tSNE)ï¼š ç”¨äºŽå¯è§†åŒ–ï¼ŒæŠŠé«˜ç»´æ•°æ®æŠ•å°„åˆ° 2D/3Dã€‚ 4. é‚»å±…å›¾æž„å»ºä¸Žèšç±» FindNeighborsï¼šæž„å»º kNN å›¾æˆ– SNN å›¾ã€‚ FindClustersï¼šåŸºäºŽå›¾çš„ç¤¾åŒºæ£€æµ‹ç®—æ³•ï¼ˆLouvain/Leidenï¼‰ï¼Œå¾—åˆ°ç»†èƒžç°‡ã€‚ æ„ä¹‰ï¼šæŠŠè¡¨è¾¾ç›¸ä¼¼çš„ç»†èƒžå½’ä¸ºä¸€ç¾¤ã€‚ 5. ç»†èƒžç±»åž‹æ³¨é‡Š æ‰¾ marker åŸºå›  (FindAllMarkers)ï¼šæ¯ä¸ª cluster çš„ç‰¹å¼‚è¡¨è¾¾åŸºå› ã€‚ å¯¹ç…§å·²çŸ¥ markerï¼šæŽ¨æ–­ cluster å¯¹åº”çš„ç»†èƒžç±»åž‹ã€‚ å¯é€‰ï¼šç”¨å‚è€ƒæ•°æ®åº“æˆ–è‡ªåŠ¨åŒ–å·¥å…·ï¼ˆSingleR, CellTypistï¼‰ã€‚ 6. ä¸‹æ¸¸åˆ†æž æ ¹æ®ç ”ç©¶é—®é¢˜ä¸åŒï¼Œå¯èƒ½åŒ…æ‹¬ï¼š å·®å¼‚è¡¨è¾¾åˆ†æž (FindMarkers)ï¼šæ¯”è¾ƒä¸åŒ cluster / æ¡ä»¶ä¸‹çš„åŸºå› è¡¨è¾¾å·®å¼‚ã€‚ è½¨è¿¹æŽ¨æ–­ (pseudotime)ï¼šMonocle/Slingshot åˆ†æžå‘è‚²æˆ–åˆ†åŒ–è½¨è¿¹ã€‚ ç»†èƒžé€šè®¯ (CellChat, CellPhoneDB)ï¼šé¢„æµ‹ç»†èƒžé—´é…ä½“-å—ä½“ç›¸äº’ä½œç”¨ã€‚ åŸºå› è°ƒæŽ§ç½‘ç»œ (SCENIC, pySCENIC)ï¼šæŽ¨æ–­è½¬å½•å› å­æ´»æ€§ã€‚ å¤šç»„å­¦æ•´åˆ (WNN, MOFA+, Seurat v5)ï¼šæ•´åˆ RNAã€ATACã€ADT ç­‰ã€‚ 7. å¯è§†åŒ–ä¸ŽéªŒè¯ UMAP/tSNE å›¾ä¸Šå±•ç¤º cluster/marker è¡¨è¾¾ã€‚ å°æç´å›¾ã€çƒ­å›¾å±•ç¤ºåŸºå› è¡¨è¾¾æ¨¡å¼ã€‚ å¯¹å…³é”®ç»“æžœåšå®žéªŒéªŒè¯ï¼ˆqPCR, FISH, flow cytometryï¼‰ã€‚ âœ… ä¸€å¥è¯æ€»ç»“ å•ç»†èƒžåˆ†æžæ€è·¯ = è´¨æŽ§ â†’ å½’ä¸€åŒ– â†’ ç‰¹å¾é€‰æ‹© â†’ é™ç»´ â†’ æž„å›¾èšç±» â†’ æ³¨é‡Š â†’ ä¸‹æ¸¸åˆ†æžï¼ˆå·®å¼‚ã€è½¨è¿¹ã€é€šè®¯ç­‰ï¼‰ã€‚ å®ƒçš„æ ¸å¿ƒæ˜¯æŠŠé«˜ç»´ noisy çš„å•ç»†èƒžæ•°æ®ï¼Œé€šè¿‡é™ç»´å’Œèšç±»æ•´ç†æˆæœ‰ç”Ÿç‰©å­¦æ„ä¹‰çš„ç»†èƒžç¾¤ä½“ï¼Œç„¶åŽç»“åˆ marker/åŠŸèƒ½ä¿¡æ¯è§£è¯»"},{"title":"github éƒ¨ç½²hexoé™æ€åšå®¢","date":"2025-09-19T07:22:56.000Z","url":"/myblog.github.io/posts/github-%E9%83%A8%E7%BD%B2hexo%E9%9D%99%E6%80%81%E5%8D%9A%E5%AE%A2/","tags":[["è®°å½•","/myblog.github.io/tags/%E8%AE%B0%E5%BD%95/"],["hexo","/myblog.github.io/tags/hexo/"]],"categories":[["undefined",""]],"content":" éƒ¨ç½²hexoåˆ°Github ä¸€ã€åˆ›å»ºgithubé¡¹ç›®ä»“åº“ åœ¨githubé¡µé¢åˆ›å»ºä¸€ä¸ªè‡ªå·±çš„ä»“åº“ï¼Œè¿™ä¸ªåº”è¯¥æ²¡å•¥é—®é¢˜ ç„¶åŽæ‹‰å–è¿œç¨‹ä»“åº“ï¼ˆæˆ‘è¿™è¾¹ç”¨çš„æ˜¯kratos rebirthçš„æ¨¡æ¿ï¼Œä»¥ä¸‹ä»¥æ­¤æ¨¡æ¿ä¸ºä¾‹ï¼‰ ä¿®æ”¹å®Œé…ç½®åŽç”¨hexoè¿›è¡Œéƒ¨ç½² æ³¨æ„ï¼šåœ¨éƒ¨ç½²çš„æ—¶å€™åˆ†æ”¯ä¸Žä¿®æ”¹æ ¼å¼å†…å®¹çš„åˆ†æ”¯å°½é‡é‡å‘½åï¼Œä»¥å…åŽæœŸå‘ç”Ÿgit mergeäº‹ä»¶ï¼ï¼ï¼ äºŒã€ä¹‹åŽå°±æ˜¯hexoçš„éƒ¨ç½² ç„¶åŽå°±å®Œæˆéƒ¨ç½²äº† æ›´æ–°ï¼š å°è¯•éƒ¨ç½²åˆ°cloudflareä¸Šï¼Œä½†æ˜¯å‘çŽ°é™æ€æ–‡ä»¶çš„è·¯å¾„ä¸å¯ç”¨ï¼Œéƒ¨ç½²ä¸Šçš„ç½‘é¡µæ— æ³•æ¸²æŸ“ï¼Œé‚ä¿®æ”¹é™æ€èµ„æºè·¯å¾„ï¼Œé‡æ–°å¼€è®¾äº†ä¸€ä¸ªåˆ†æ”¯cloudflareï¼Œä½†æ˜¯åŽæ¥å‘çŽ°è¦æ›´æ–°2æ¬¡å°±æ”¾å¼ƒäº†ã€‚ã€‚ã€‚"},{"title":"è®°å½•ä¸€ä¸‹ä½¿ç”¨kratosæ¨¡æ¿åˆ›å»ºä¸ªäººåšå®¢","date":"2025-09-18T09:03:28.000Z","url":"/myblog.github.io/posts/%E8%AE%B0%E5%BD%95%E4%B8%80%E4%B8%8B%E4%BD%BF%E7%94%A8kratos%E6%A8%A1%E6%9D%BF%E5%88%9B%E5%BB%BA%E4%B8%AA%E4%BA%BA%E5%8D%9A%E5%AE%A2/","tags":[["è®°å½•","/myblog.github.io/tags/%E8%AE%B0%E5%BD%95/"],["kratos","/myblog.github.io/tags/kratos/"]],"categories":[["new!","/myblog.github.io/categories/new/"]],"content":" è®°å½•ä¸€ä¸‹ä½¿ç”¨kratosæ¨¡æ¿åˆ›å»ºä¸ªäººåšå®¢ ä»¥ä¸‹æ˜¯ç”¨äºŽç¾ŽåŒ–çš„cssæ–‡ä»¶ èŠ±äº†ä¸€ä¸ªä¸‹åˆç ”ç©¶è¿™çŽ©æ„ï¼Œè€Œä¸”åœ¨ä¸€äº›å¥‡æ€ªçš„åœ°æ–¹æœ‰BUGã€‚ æœ€ç»ˆæˆæžœå¦‚å›¾ï¼š äºŽ2025å¹´9æœˆ18æ—¥17:01:49ï¼ŒNJU"},{"date":"2025-09-19T08:57:45.003Z","url":"/myblog.github.io/comments/gitalk.css","categories":[["undefined",""]],"content":".gt-counts, .gt-header-textarea, .gt-user-name { color: var(--kr-theme-text) !important; } .gt-header-textarea, .gt-header-preview, .gt-btn-preview, .gt-comment-content{ border-radius: 15px; } .gt-popup { background-color: var(--kr-theme-page-bg) !important; } .gt-popup { border-color: #6190e8 !important; }"},{"date":"2025-09-19T08:20:54.524Z","url":"/myblog.github.io/comments/gitalk.js","categories":[["undefined",""]],"content":"(() => { const loadComments = async () => { if (typeof Gitalk === \"undefined\") { setTimeout(loadComments, 100); } else { const container = document.getElementById('gitalk-container'); if (!container) { return; } const path = container.getAttribute(\"data-path\"); const gitalk = new Gitalk(Object.assign({ // id: path, // ç›´æŽ¥ä½¿ç”¨è·¯å¾„ä½œä¸º id id: container.getAttribute(\"data-path-hash\"), // ä½¿ç”¨ hash ä½œä¸º ID path: path, }, { clientID: 'Ov23liEPcwPsUXR6o3wk', clientSecret: 'c10c8e0b8605cbbb07977c874a7b628938d8bc87', repo: \"myblog.github.io\", owner: \"Hyperion1230\", admin: [\"Hyperion1230\"], distractionFreeMode: false, })); gitalk.render('gitalk-container'); } }; window.loadComments = loadComments; window.addEventListener('pjax:success', () => { window.loadComments = loadComments; }); })();"},{"date":"2025-09-19T08:58:08.340Z","url":"/myblog.github.io/css/custom.css","categories":[["undefined",""]],"content":"/* ä¿®æ”¹å¯¼èˆªæ èƒŒæ™¯è‰² */ .kratos-topnav { background: #085c0999 !important; justify-content: center; height: 80px; } .sf-menu { display: flex; justify-content: center; } /* æ‚¬åœé«˜äº®æ•ˆæžœ */ /* ç§»é™¤å¯¼èˆªèœå•æ‚¬åœæ•ˆæžœ */ /* ç§»é™¤å¯¼èˆªèœå•æ‚¬åœæ•ˆæžœ */ /* è°ƒæ•´å¯¼èˆªå­—ä½“å¤§å°å’Œé—´è· */ #kratos-menu-wrap .sf-menu a { color: #ffffff; /* text-shadow: 0 0 10px #000000, 0 0 20px #000000, 0 0 30px #000000; */ margin: 10px 10px; font-size: 20px; } #kratos-menu-wrap .sf-menu a { border: 2px solid #090909; background-color: #d4d4d499; border-radius: 15px; } #kratos-desktop-topnav .sf-menu>li>ul.sub-menu a { color: #000000; } .kratos-entry-footer .footer-tag a { color: #000000; background-color: #ffffff; border-radius: 15px; } #kratos-widget-area .widget.widget-kratos-about{ padding-left: 0; padding-right: 0; padding-top: 0; border-radius: 15px } #kratos-widget-area .widget:last-child { border-radius: 15px; } .kratos-entry-border .kratos-entry-post-meta { border-radius: 15px; } #kratos-blog-post .row article{ border-radius: 15px; } #kratos-desktop-topnav .sf-menu>li>ul.sub-menu li a { font-size: 15px; margin-left: auto; margin-right: auto; text-align: center; } #kratos-desktop-topnav .sf-menu>li>ul.sub-menu{ left:0px; } .kratos-hentry, .navigation div, #kratos-widget-area .widget{ border-radius: 15px; } .kr-comments { border-radius: 15px; }"}]